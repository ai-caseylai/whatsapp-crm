# WhatsApp 聊天分析完整指南

## 📋 概述

本指南提供簡單易用的方法，讓非技術用戶也能輕鬆將 WhatsApp 聊天內容導入系統並使用 Gemini AI 進行智能分析。

---

## 🎯 方案 A：系統內建功能（推薦）

### 優點
- ✅ 完全在系統內操作，無需額外工具
- ✅ 一鍵導出和分析
- ✅ 自動格式化和標籤
- ✅ 即時查看分析結果

### 步驟

#### 1️⃣ 導出聊天記錄

**在 WhatsApp CRM 系統中：**

1. 登入系統：http://localhost:3000
2. 從左側聯絡人列表選擇要分析的聊天
3. 在聊天視窗頂部找到「分析」按鈕（🔍 圖標）
4. 點擊「導出並分析」

**系統會自動：**
- 📤 導出該聯絡人的所有對話記錄
- 📊 轉換為適合分析的格式
- 🤖 發送到 Gemini AI 進行分析

#### 2️⃣ 選擇分析類型

系統提供多種分析選項：

| 分析類型 | 說明 | 適用場景 |
|---------|------|---------|
| **情緒分析** | 識別對話中的情緒傾向 | 客戶滿意度評估 |
| **主題提取** | 自動識別討論主題 | 了解客戶需求 |
| **關鍵資訊** | 提取電話、地址、日期等 | 整理客戶資料 |
| **對話摘要** | 生成對話重點摘要 | 快速了解歷史 |
| **待辦事項** | 識別承諾和待辦項目 | 追蹤跟進事項 |
| **客戶分類** | 自動標記客戶類型 | 客戶分群管理 |

#### 3️⃣ 查看分析結果

分析完成後，系統會在聊天視窗右側顯示：

```
┌─────────────────────────┐
│  📊 分析結果            │
├─────────────────────────┤
│ 😊 情緒: 積極 (85%)     │
│ 🏷️ 標籤: VIP客戶、急單  │
│ 📝 摘要: 客戶詢問產品... │
│ ⏰ 待辦: 週五前報價     │
│ 📞 電話: 852-1234-5678  │
└─────────────────────────┘
```

#### 4️⃣ 保存和應用標籤

1. 點擊「應用標籤」按鈕
2. 系統自動將分析結果保存到聯絡人資料
3. 可在聯絡人列表看到新標籤
4. 使用標籤進行篩選和分組

---

## 🎯 方案 B：手動導出（適用於外部 WhatsApp 對話）

### 步驟 1：從 WhatsApp 導出對話

#### 📱 手機端操作

**iPhone：**
1. 打開 WhatsApp，進入聊天
2. 點擊聊天名稱 → 滑到底部
3. 點擊「導出聊天記錄」
4. 選擇「不附帶媒體」（更快）
5. 選擇「郵件」或「儲存到檔案」

**Android：**
1. 打開 WhatsApp，進入聊天
2. 點擊 ⋮（右上角）→「更多」
3. 點擊「導出聊天記錄」
4. 選擇「不附帶媒體」
5. 選擇分享方式（郵件/雲端）

#### 💻 電腦端操作

**WhatsApp Web/Desktop：**
1. 打開 WhatsApp 網頁版
2. 點擊聊天右上角的 ⋮
3. 選擇「更多」→「導出聊天記錄」
4. 文件自動下載為 `.txt` 格式

**導出的文件格式範例：**
```
[2024/01/15, 10:30:25] 客戶: 你好，請問有貨嗎？
[2024/01/15, 10:32:10] 你: 您好！有的，請問需要什麼型號？
[2024/01/15, 10:35:45] 客戶: 我要 XYZ-001，5個
```

---

### 步驟 2：上傳到系統

#### 方法 1：網頁上傳（最簡單）

1. 登入 WhatsApp CRM 系統
2. 點擊頂部導航欄的「分析」按鈕
3. 點擊「上傳聊天記錄」
4. 選擇導出的 `.txt` 文件
5. 點擊「開始分析」

#### 方法 2：拖放上傳

1. 直接將 `.txt` 文件拖到分析區域
2. 系統自動識別和處理
3. 等待分析完成

---

### 步驟 3：數據格式轉換（自動完成）

系統會自動處理以下轉換：

| 原始格式 | 轉換後 | 用途 |
|---------|--------|------|
| `[日期, 時間] 發送者: 內容` | JSON 結構化數據 | AI 分析 |
| 表情符號 | 情緒標記 | 情緒分析 |
| 電話號碼 | 提取並驗證 | 聯絡資訊 |
| 日期時間 | 標準化格式 | 時間軸分析 |

**轉換範例：**

```json
{
  "conversation": [
    {
      "timestamp": "2024-01-15T10:30:25",
      "sender": "客戶",
      "message": "你好，請問有貨嗎？",
      "sentiment": "neutral"
    },
    {
      "timestamp": "2024-01-15T10:32:10",
      "sender": "你",
      "message": "您好！有的，請問需要什麼型號？",
      "sentiment": "positive"
    }
  ],
  "metadata": {
    "total_messages": 2,
    "duration": "5 minutes",
    "participants": ["客戶", "你"]
  }
}
```

---

### 步驟 4：Gemini 分析設定

#### 自動分析功能

系統會自動執行以下分析：

**1. 基礎分析（免費，即時）**
- ✅ 訊息數量統計
- ✅ 回應時間分析
- ✅ 活躍時段識別
- ✅ 參與度評分

**2. AI 智能分析（使用 Gemini）**
- 🤖 情緒趨勢分析
- 🤖 關鍵議題提取
- 🤖 客戶意圖識別
- 🤖 行動建議生成

#### 自定義分析提示

可以設定自定義分析重點：

1. 點擊「高級設定」
2. 選擇分析重點：
   - ☑️ 購買意向
   - ☑️ 投訴和問題
   - ☑️ 價格敏感度
   - ☑️ 競品比較
   - ☑️ 決策進度
3. 添加自定義問題（可選）
4. 點擊「開始分析」

**自定義問題範例：**
```
- 客戶是否提到預算限制？
- 有哪些未解決的問題？
- 客戶的購買時間表是什麼？
- 是否需要跟進？何時？
```

---

## 📊 分析結果展示

### 結果儀表板

分析完成後，系統顯示：

#### 1. 對話摘要卡片
```
╔══════════════════════════════════╗
║  📅 對話時間: 2024-01-15        ║
║  💬 訊息總數: 45                ║
║  ⏱️ 持續時間: 2小時15分          ║
║  😊 整體情緒: 積極 (78%)        ║
╚══════════════════════════════════╝
```

#### 2. 智能標籤
```
🏷️ 自動標籤：
┌─────────────┬──────────┬──────────┐
│ VIP 客戶    │ 緊急訂單 │ 需跟進   │
│ 價格敏感    │ 技術諮詢 │ 潛在客戶 │
└─────────────┴──────────┴──────────┘
```

#### 3. 關鍵資訊提取
```
📋 提取的關鍵資訊：
• 聯絡電話: +852-1234-5678
• 電郵: customer@example.com
• 公司名稱: ABC Limited
• 產品型號: XYZ-001 (數量: 5)
• 預算範圍: HKD 10,000 - 15,000
• 交貨日期: 2024-01-20
```

#### 4. 時間軸分析
```
📈 對話進度：
10:30 ━━━ 初次詢問
10:45 ━━━ 產品說明
11:20 ━━━ 價格討論
11:50 ━━━ 達成共識 ✅
```

#### 5. 行動建議
```
💡 AI 建議：
1. ⚠️ 緊急：客戶要求週五前報價
2. 📞 跟進：確認技術規格細節
3. 💰 機會：客戶表示可能增加訂單
4. 📧 發送：產品規格表和案例
```

---

## 🛠️ 所需工具和軟體

### 必備工具（免費）

| 工具 | 用途 | 下載/訪問 |
|-----|------|----------|
| **WhatsApp** | 聊天記錄導出 | 手機上已安裝 |
| **瀏覽器** | 訪問 CRM 系統 | Chrome/Safari/Firefox |
| **WhatsApp CRM** | 分析平台 | http://localhost:3000 |

### 可選工具

| 工具 | 用途 | 何時需要 |
|-----|------|---------|
| **文本編輯器** | 查看/編輯 `.txt` 文件 | 需要預處理時 |
| **Excel/Google Sheets** | 導出分析報表 | 需要進一步分析 |
| **PDF 生成器** | 保存分析報告 | 需要存檔時 |

---

## 🔄 批量分析流程

### 分析多個聊天記錄

#### 方法 1：系統內批量選擇
1. 在聯絡人列表按住 Ctrl/Cmd 多選
2. 點擊「批量操作」→「分析聊天」
3. 選擇分析類型
4. 等待批量處理完成

#### 方法 2：批量上傳文件
1. 點擊「分析」→「批量上傳」
2. 一次選擇多個 `.txt` 文件
3. 系統自動處理每個文件
4. 生成批量分析報告

**批量分析限制：**
- 單次最多: 50 個聊天
- 每個聊天: 最多 10,000 條訊息
- 預計時間: 每個聊天約 10-30 秒

---

## 📤 導出和分享結果

### 導出格式選項

| 格式 | 適用場景 | 內容 |
|-----|---------|------|
| **PDF** | 正式報告、存檔 | 完整分析 + 圖表 |
| **Excel** | 數據分析、統計 | 結構化數據 |
| **JSON** | 技術整合 | 原始數據 |
| **圖片** | 快速分享 | 視覺化圖表 |

### 導出步驟
1. 分析完成後，點擊「導出」
2. 選擇格式（PDF/Excel/JSON）
3. 選擇包含內容：
   - ☑️ 對話摘要
   - ☑️ 標籤和分類
   - ☑️ 關鍵資訊
   - ☑️ 時間軸
   - ☑️ AI 建議
4. 點擊「下載」

---

## 🎨 自動標籤系統

### 預設標籤類別

系統會自動應用以下標籤：

#### 客戶類型
- 🌟 VIP 客戶
- 🆕 新客戶
- 🔁 回頭客
- 💤 沉睡客戶

#### 購買階段
- 🔍 了解階段
- 💭 考慮階段
- 💰 決策階段
- ✅ 已成交
- ❌ 已流失

#### 情緒狀態
- 😊 滿意
- 😐 中立
- 😟 不滿
- 😡 投訴

#### 優先級
- 🔴 緊急
- 🟡 重要
- 🟢 一般
- ⚪ 低優先

### 自定義標籤規則

可以設定自動標籤規則：

1. 進入「設定」→「標籤規則」
2. 點擊「新增規則」
3. 設定條件：
   ```
   當對話包含關鍵字「急」或「緊急」
   → 自動添加標籤「🔴 緊急」
   ```
4. 保存並應用

---

## 🔐 隱私和安全

### 數據保護

- 🔒 所有聊天記錄本地存儲
- 🔐 傳輸使用 HTTPS 加密
- 🗑️ 可隨時刪除分析數據
- 👤 僅授權用戶可訪問

### Open Router 隱私

- ✅ 不保存對話內容
- ✅ 僅用於即時分析
- ✅ 不用於 AI 訓練
- ✅ 符合 GDPR 規範

---

## 💡 使用技巧

### 提高分析準確度

1. **清理數據**
   - 移除系統通知（「訊息已刪除」等）
   - 保留完整的上下文
   
2. **提供背景資訊**
   - 在分析前添加客戶備註
   - 標記重要對話

3. **定期分析**
   - 建議每週分析一次
   - 追蹤趨勢變化

4. **結合人工判斷**
   - AI 建議供參考
   - 最終決策由人做出

---

## ❓ 常見問題

### Q1: 分析需要多長時間？
**A:** 通常 10-30 秒，取決於對話長度。批量分析可能需要幾分鐘。

### Q2: 支持哪些語言？
**A:** 支持繁體中文、簡體中文、英文等多種語言，Gemini 會自動識別。

### Q3: 文件大小有限制嗎？
**A:** 單個文件最大 10MB，約 10,000 條訊息。

### Q4: 分析是否消耗 API 配額？
**A:** 是的，但使用 Open Router 免費版通常足夠日常使用。

### Q5: 可以分析群組聊天嗎？
**A:** 可以！系統會識別多個參與者並分別分析。

### Q6: 如何刪除分析記錄？
**A:** 在分析結果頁面點擊「刪除」，或在設定中批量清除。

### Q7: 分析結果可以修改嗎？
**A:** 可以手動編輯標籤、摘要等內容。

### Q8: 支持自動化分析嗎？
**A:** 可以設定自動分析規則，新對話超過一定長度自動觸發。

---

## 🚀 快速開始檢查清單

開始使用前，確認以下事項：

- [ ] 已登入 WhatsApp CRM 系統
- [ ] Gemini API Key 已配置（查看 `.env` 文件）
- [ ] 了解基本操作流程
- [ ] 準備好要分析的聊天記錄
- [ ] 知道如何導出 WhatsApp 對話

**準備就緒？** 👉 [開始分析](#方案-a系統內建功能推薦)

---

## 📞 技術支援

遇到問題？

1. 查看本指南的常見問題部分
2. 檢查系統日誌：`tail -f server.log`
3. 聯繫技術支持
4. 查看 GitHub Issues

---

## 📝 更新日誌

### v1.0 (2024-02-07)
- ✨ 初始版本
- ✅ 支持基礎分析功能
- ✅ 集成 Gemini AI
- ✅ 自動標籤系統

### 計劃中的功能
- 🔜 多語言分析報告
- 🔜 語音訊息轉文字
- 🔜 圖片內容識別
- 🔜 情緒趨勢圖表
- 🔜 客戶旅程地圖

---

**祝你使用愉快！** 🎉

如有任何問題，歡迎隨時聯繫技術支持團隊。
