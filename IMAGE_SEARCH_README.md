# åœ–ç‰‡æœç´¢åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“‹ åŠŸèƒ½èªªæ˜

ç‚º WhatsApp åœ–ç‰‡æ¶ˆæ¯æ·»åŠ  AI ç”Ÿæˆçš„æ–‡å­—æè¿°ï¼Œå¯¦ç¾å¿«é€Ÿæœç´¢åœ–ç‰‡å…§å®¹ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. è¨­ç½®ç’°å¢ƒè®Šæ•¸

åœ¨ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```bash
# å¿…éœ€
JINA_API_KEY=your_jina_api_key
OPENROUTER_API_KEY=your_openrouter_api_key

# æˆ–è€…ä½¿ç”¨ OpenAIï¼ˆäºŒé¸ä¸€ï¼‰
OPENAI_API_KEY=your_openai_api_key
```

### 2. ç²å– API å¯†é‘°

- **OpenRouter**: https://openrouter.ai/keys (æ¨è–¦ï¼Œæ›´ä¾¿å®œ)
- **OpenAI**: https://platform.openai.com/api-keys
- **Jina AI**: https://jina.ai/embeddings/ (ç”¨æ–¼ç”Ÿæˆå‘é‡)

### 3. é‹è¡Œè™•ç†è…³æœ¬

#### æ–¹æ¡ˆ Aï¼šä½¿ç”¨ OpenRouterï¼ˆæ¨è–¦ï¼‰

```bash
node process-images-openrouter.js
```

**å„ªé»ï¼š**
- ğŸ’° æ›´ä¾¿å®œï¼ˆç´„ $0.002/å¼µåœ–ç‰‡ï¼‰
- ğŸ¯ å¤šç¨®æ¨¡å‹å¯é¸
- âš¡ æ€§èƒ½å¥½

**å¯ç”¨æ¨¡å‹ï¼š**
- `gpt-4o-mini` - ä¾¿å®œå¿«é€Ÿï¼ˆé»˜èªï¼‰
- `claude-3-haiku` - Anthropic ä¾¿å®œç‰ˆ
- `gemini-flash` - Google å¿«é€Ÿç‰ˆ
- `gpt-4o` - OpenAI é«˜è³ªé‡
- `claude-3.5-sonnet` - Anthropic é«˜è³ªé‡

#### æ–¹æ¡ˆ Bï¼šä½¿ç”¨ OpenAI

```bash
node process-image-messages.js
```

#### æ–¹æ¡ˆ Cï¼šåªä½¿ç”¨åœ–ç‰‡èªªæ˜æ–‡å­—ï¼ˆå…è²»ï¼‰

å¦‚æœåœ–ç‰‡å·²ç¶“æœ‰èªªæ˜æ–‡å­—ï¼Œå¯ä»¥ç›´æ¥å‘é‡åŒ–ï¼š

```bash
node process-image-captions.js
```

### 4. æœç´¢åœ–ç‰‡

```bash
# æœç´¢åŒ…å«ç‰¹å®šå…§å®¹çš„åœ–ç‰‡
node search-images.js "å¸†èˆ¹"
node search-images.js "ç¾é£Ÿ"
node search-images.js "é¢¨æ™¯ç…§ç‰‡"
```

## ğŸ“Š è™•ç†çµ±è¨ˆ

è…³æœ¬æœƒè‡ªå‹•ï¼š
1. âœ… ç²å–æ‰€æœ‰åœ–ç‰‡æ¶ˆæ¯
2. ğŸ¤– ä½¿ç”¨ AI åˆ†æåœ–ç‰‡å…§å®¹
3. ğŸ§  ç”Ÿæˆå‘é‡ embedding
4. ğŸ’¾ ä¿å­˜åˆ°çŸ¥è­˜åº«

è™•ç†å®Œæˆå¾Œæœƒé¡¯ç¤ºï¼š
- ç¸½åœ–ç‰‡æ•¸
- å·²è™•ç†æ•¸é‡
- æˆåŠŸ/å¤±æ•—æ•¸é‡
- é ä¼°æˆæœ¬

## ğŸ’° æˆæœ¬ä¼°ç®—

### OpenRouter (æ¨è–¦)
- **GPT-4o-mini**: ~$0.002/å¼µåœ–ç‰‡
- **Claude-3-haiku**: ~$0.003/å¼µåœ–ç‰‡
- **Gemini-flash**: ~$0.001/å¼µåœ–ç‰‡

### OpenAI
- **GPT-4o-mini**: ~$0.003/å¼µåœ–ç‰‡
- **GPT-4o**: ~$0.01/å¼µåœ–ç‰‡

**ä¾‹å­ï¼š**
- è™•ç† 100 å¼µåœ–ç‰‡ä½¿ç”¨ GPT-4o-mini: ~$0.20 USD
- è™•ç† 1000 å¼µåœ–ç‰‡ä½¿ç”¨ GPT-4o-mini: ~$2.00 USD

## ğŸ”§ è‡ªå®šç¾©é…ç½®

### ä¿®æ”¹è™•ç†æ•¸é‡é™åˆ¶

åœ¨è…³æœ¬ä¸­æ‰¾åˆ°ä¸¦ä¿®æ”¹ï¼š

```javascript
const PROCESS_LIMIT = 100; // æ”¹ç‚ºä½ æƒ³è™•ç†çš„æ•¸é‡
```

### åˆ‡æ› Vision æ¨¡å‹

åœ¨ `process-images-openrouter.js` ä¸­ä¿®æ”¹ï¼š

```javascript
const SELECTED_MODEL = VISION_MODELS['gpt-4o-mini']; // æ”¹ç‚ºå…¶ä»–æ¨¡å‹
```

## ğŸ“ æœç´¢çµæœç¤ºä¾‹

```
ğŸ” æœç´¢åœ–ç‰‡: "å¸†èˆ¹"

âœ… æ‰¾åˆ° 3 å€‹ç›¸é—œåœ–ç‰‡

1. ğŸ‘¤ Kiasu L Sailing â›µ
   ç›¸ä¼¼åº¦: 85.3%
   æ™‚é–“: 2026/2/7 ä¸‹åˆ3:18
   
   ğŸ“ AI æè¿°:
   åœ–ç‰‡é¡¯ç¤ºä¸€è‰˜ç™½è‰²å¸†èˆ¹åœ¨è—è‰²æµ·é¢ä¸Šèˆªè¡Œï¼Œ
   èƒŒæ™¯æ˜¯æ™´æœ—çš„å¤©ç©ºå’Œé è™•çš„å±±è„ˆ...
```

## âš ï¸ æ³¨æ„äº‹é …

1. **API æˆæœ¬**: Vision API æœƒç”¢ç”Ÿè²»ç”¨ï¼Œå»ºè­°å…ˆå°é‡æ¸¬è©¦
2. **è™•ç†æ™‚é–“**: æ¯å¼µåœ–ç‰‡éœ€è¦ 1-3 ç§’è™•ç†æ™‚é–“
3. **Rate Limit**: è…³æœ¬å·²åŒ…å«å»¶é²ä»¥é¿å…è¶…é API é™åˆ¶
4. **åœ–ç‰‡å¯è¨ªå•æ€§**: ç¢ºä¿åœ–ç‰‡ URL å¯ä»¥è¢« API è¨ªå•

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œï¼šæ‰¾ä¸åˆ°åœ–ç‰‡æ¶ˆæ¯
- æª¢æŸ¥ `SESSION_ID` æ˜¯å¦æ­£ç¢º
- ç¢ºèªæ•¸æ“šåº«ä¸­æœ‰åœ–ç‰‡é¡å‹çš„æ¶ˆæ¯

### å•é¡Œï¼šAPI éŒ¯èª¤
- ç¢ºèª API å¯†é‘°æ­£ç¢º
- æª¢æŸ¥ API é…é¡æ˜¯å¦ç”¨å®Œ
- ç¢ºèªåœ–ç‰‡ URL å¯ä»¥è¨ªå•

### å•é¡Œï¼šæœç´¢æ‰¾ä¸åˆ°çµæœ
- ç¢ºèªå·²ç¶“é‹è¡Œè™•ç†è…³æœ¬
- æª¢æŸ¥çŸ¥è­˜åº«ä¸­æ˜¯å¦æœ‰åœ–ç‰‡é¡å‹çš„æ–‡æª”ï¼š
  ```bash
  node -e "
  const { createClient } = require('@supabase/supabase-js');
  const supabase = createClient('your_url', 'your_key');
  supabase.from('rag_knowledge').select('*', { count: 'exact' })
    .eq('source_type', 'image').then(({count}) => console.log('åœ–ç‰‡æ–‡æª”æ•¸:', count));
  "
  ```

## ğŸ“š ç›¸é—œæ–‡ä»¶

- `process-images-openrouter.js` - ä½¿ç”¨ OpenRouter è™•ç†åœ–ç‰‡
- `process-image-messages.js` - ä½¿ç”¨ OpenAI è™•ç†åœ–ç‰‡
- `process-image-captions.js` - åªè™•ç†åœ–ç‰‡èªªæ˜æ–‡å­—
- `search-images.js` - æœç´¢åœ–ç‰‡
- `test-vector-search.js` - æ¸¬è©¦å‘é‡æœç´¢

## ğŸ¯ ä¸‹ä¸€æ­¥

1. å…ˆç”¨å°é‡åœ–ç‰‡æ¸¬è©¦ï¼ˆä¿®æ”¹ `PROCESS_LIMIT = 10`ï¼‰
2. ç¢ºèªçµæœæ»¿æ„å¾Œå†è™•ç†æ›´å¤šåœ–ç‰‡
3. å®šæœŸé‹è¡Œè…³æœ¬è™•ç†æ–°çš„åœ–ç‰‡æ¶ˆæ¯
